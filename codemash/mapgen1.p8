pico-8 cartridge // http://www.pico-8.com
version 38
__lua__
-- button constants
‚¨ÜÔ∏è = 2
‚¨ÖÔ∏è = 0
‚û°Ô∏è = 1
‚¨áÔ∏è = 3
‚ùé = 4
üÖæÔ∏è = 5
max_speed = 1.5

function _init()
 player = {
  x = 64,
  y = 64,
  dx = 0,
  dy = 0,
  spd = 1,
  jump = 1,
  on_ground = 0
 }
 gen_map()
end

function _draw()
 cls()
 camera(player.x-24,0)
 map()
 spr(0,player.x,player.y)
end

function _update60()
 local p = player
 -- apply gravity
 p.dy=p.dy+0.05
 -- up/ down
 if (btn(‚û°Ô∏è)) then
  p.dx=p.dx+0.05
 end
 if (btn(‚¨ÖÔ∏è)) then
   p.dx=p.dx-0.05
 end
 -- jump
 if btnp(üÖæÔ∏è) and 
   (p.on_ground or p.jump<1) then
   p.on_ground=false
   p.jump+=1
   p.dy=p.dy-2
 end
 
 -- check wall coll
 if hit(p.x+p.dx,p.y,7,7,1) then
  player.dx=0
 end
  
 -- check ground coll
 if hit(p.x,p.y+p.dy,7,7,1) then
  if p.dy>0 then
   p.on_ground=true
  end
   p.dy=0        
 end
 
 -- decel if on ground
 if p.on_ground then
  p.jump=0
 end
 
 -- max acceleration
 if p.dx > max_speed then
  p.dx = max_speed
 end
 
 -- update forward/ upward motion 
 p.y=p.y+p.dy
 p.x=p.x+p.dx
 
 -- reset to beginning
 -- generate more map
 if p.x >= (127-12)*8 then
  p.x = 24
  gen_map()
 end
end
-->8
function hit(x,y,w,h,flag)
 collide=false
  
 for i=x,x+w,w do
  if (fget(mget(i/8,y/8))==flag) or
         (fget(mget(i/8,(y+h)/8))==flag) then
   collide=true
  end
 end
  
 return collide
end
-->8
function gen_map()
 --clear
 for i=0,127 do
  for j=0,15 do
  	mset(i,j,3)
  end 
 end
 -- set flat space at begin/ end
	for i=0,15 do
		mset(i,15,1)
	end
	for i=112,127 do
		mset(i,15,1)
	end
	-- set variable space
	for i=16,111 do
	 for j=0,rnd(6)-2 do
	   -- negative nums make no floors
				mset(i,15-j,1)
			if rnd(100)>90 then
				mset(i,8,2)
			end
		end
 end
end
__gfx__
00444400666666660000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
047ff740676556760000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00ffff00665555660000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
08888880655665560000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
08888880655665560000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0f1111f0665555660000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00100100676556760000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
05500550666666660000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000101000101010101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000001010101010100000000000001010101010101000000000000000000000000000000000000000000000000000000000000000001010101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000101010100000000000000000000000000000000000001010100000000000000000000000000000000000000000000000000000001010100000001010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000101000101010000000000000000000000000000000000000000000000000101000101010101010101010101000000000000000000000001010100000000000000010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000101000100010000000000000000000000000000000000000000000000000000000000000000000000000000000000000001010100000000000001010100000000000000000000000001010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0001010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101010101010101000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000010101010000000000010100000000000000000000000000000000000000000101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000001010101010101010101010100000000000000000000010101000000000000000000000101000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000010101000000000000000000000101000000000000000001010000000000000000000000000001010100000000000000000000000000000000010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000101010000000000000000000000000001010101010000000101000000000000000000000000000000000101010101000000000000000000000001010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0101010101010101010101010100000000000000000000000000000000000000010101010100000000000000000000000000000000000000000001010101010101010101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
